# -*- coding: utf-8 -*-
"""
è‚¡ç¥¨é‡åŒ–é€‰è‚¡ç³»ç»Ÿ - ä¸»åº”ç”¨å…¥å£
æ–°æ‰‹å‹å¥½çš„Webç•Œé¢ï¼Œæ— éœ€ç¼–ç¨‹çŸ¥è¯†å³å¯ä½¿ç”¨
"""

import streamlit as st
import sys
import os

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°Pythonè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

import config

# ============ é¡µé¢é…ç½® ============
st.set_page_config(
    page_title=config.STREAMLIT_TITLE,
    page_icon=config.STREAMLIT_ICON,
    layout="wide",
    initial_sidebar_state="expanded"
)

# ============ è‡ªå®šä¹‰CSSæ ·å¼ ============
st.markdown("""
<style>
    /* ä¸»æ ‡é¢˜æ ·å¼ */
    .main-title {
        font-size: 2.5rem;
        font-weight: bold;
        color: #1f77b4;
        text-align: center;
        margin-bottom: 2rem;
    }

    /* å¡ç‰‡æ ·å¼ */
    .info-card {
        background-color: #f0f2f6;
        padding: 1.5rem;
        border-radius: 0.5rem;
        margin: 1rem 0;
    }

    /* æˆåŠŸæ¶ˆæ¯æ ·å¼ */
    .success-box {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
        padding: 1rem;
        border-radius: 0.25rem;
        margin: 1rem 0;
    }

    /* è­¦å‘Šæ¶ˆæ¯æ ·å¼ */
    .warning-box {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
        padding: 1rem;
        border-radius: 0.25rem;
        margin: 1rem 0;
    }

    /* é”™è¯¯æ¶ˆæ¯æ ·å¼ */
    .error-box {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
        padding: 1rem;
        border-radius: 0.25rem;
        margin: 1rem 0;
    }
</style>
""", unsafe_allow_html=True)


# ============ ä¼šè¯çŠ¶æ€åˆå§‹åŒ– ============
def init_session_state():
    """åˆå§‹åŒ–ä¼šè¯çŠ¶æ€å˜é‡"""
    if 'page' not in st.session_state:
        st.session_state.page = 'ğŸ“Š æ•°æ®ç®¡ç†'

    if 'user_id' not in st.session_state:
        st.session_state.user_id = 'default'

    if 'first_run' not in st.session_state:
        st.session_state.first_run = True

    if 'show_tutorial' not in st.session_state:
        st.session_state.show_tutorial = False


# ============ é¡µé¢æ¸²æŸ“å‡½æ•° ============

def render_home():
    """æ¸²æŸ“é¦–é¡µ/æ¬¢è¿é¡µé¢"""
    st.markdown('<div class="main-title">ğŸ“ˆ è‚¡ç¥¨é‡åŒ–é€‰è‚¡ç³»ç»Ÿ</div>', unsafe_allow_html=True)

    st.markdown("---")

    # åŠŸèƒ½ä»‹ç»
    col1, col2, col3 = st.columns(3)

    with col1:
        st.info("""
        ### ğŸ“Š æ•°æ®ç®¡ç†
        - è‡ªåŠ¨ä¸‹è½½è‚¡ç¥¨æ•°æ®
        - æ”¯æŒå¤šå‘¨æœŸæ•°æ®
        - å¢é‡æ›´æ–°åŠŸèƒ½
        """)

    with col2:
        st.success("""
        ### âš™ï¸ ç­–ç•¥é…ç½®
        - 16ç§ç»å…¸ç­–ç•¥
        - å¯è§†åŒ–å‚æ•°è°ƒæ•´
        - ä¿å­˜è‡ªå®šä¹‰ç­–ç•¥
        """)

    with col3:
        st.warning("""
        ### ğŸ¯ æ™ºèƒ½é€‰è‚¡
        - ä¸€é”®æ‰§è¡Œé€‰è‚¡
        - ç»“æœå¯è§†åŒ–å±•ç¤º
        - å†å²è®°å½•æŸ¥è¯¢
        """)

    st.markdown("---")

    # æ•°æ®çœ‹æ¿
    st.subheader("ğŸ“Š æ•°æ®çœ‹æ¿")

    try:
        from utils.db_helper import get_db_info
        db_info = get_db_info()

        # æ•°æ®ç»Ÿè®¡
        col1, col2, col3, col4, col5 = st.columns(5)

        with col1:
            history_count = db_info.get('stock_daily_history_count', 0)
            st.metric("æ—¥çº¿æ•°æ®", f"{history_count:,}")

        with col2:
            indicator_count = db_info.get('stock_indicators_count', 0)
            st.metric("æŒ‡æ ‡æ•°æ®", f"{indicator_count:,}")

        with col3:
            stock_count = db_info.get('stock_pool_count', 0)
            st.metric("è‚¡ç¥¨æ± ", stock_count)

        with col4:
            strategy_count = db_info.get('user_strategies_count', 0)
            st.metric("ç­–ç•¥æ•°é‡", strategy_count)

        with col5:
            selection_count = db_info.get('selection_history_count', 0)
            st.metric("é€‰è‚¡è®°å½•", selection_count)

        st.markdown("---")

    except Exception as e:
        st.error(f"è·å–æ•°æ®çœ‹æ¿å¤±è´¥: {e}")

    # å¿«é€Ÿå¼€å§‹æŒ‡å—
    st.subheader("ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰")

    step1, step2, step3 = st.columns(3)

    with step1:
        st.markdown("""
        <div class="info-card">
            <h3>1ï¸âƒ£ ä¸‹è½½æ•°æ®</h3>
            <p>åœ¨"æ•°æ®ç®¡ç†"é¡µé¢ä¸‹è½½ä½ å…³æ³¨çš„è‚¡ç¥¨æ•°æ®</p>
        </div>
        """, unsafe_allow_html=True)

    with step2:
        st.markdown("""
        <div class="info-card">
            <h3>2ï¸âƒ£ é…ç½®ç­–ç•¥</h3>
            <p>åœ¨"ç­–ç•¥é…ç½®"é¡µé¢é€‰æ‹©æˆ–é…ç½®é€‰è‚¡ç­–ç•¥</p>
        </div>
        """, unsafe_allow_html=True)

    with step3:
        st.markdown("""
        <div class="info-card">
            <h3>3ï¸âƒ£ æ‰§è¡Œé€‰è‚¡</h3>
            <p>åœ¨"æ‰§è¡Œé€‰è‚¡"é¡µé¢ä¸€é”®ç­›é€‰ç¬¦åˆæ¡ä»¶çš„è‚¡ç¥¨</p>
        </div>
        """, unsafe_allow_html=True)

    st.markdown("---")

    # ç³»ç»ŸçŠ¶æ€
    st.subheader("ğŸ“‹ ç³»ç»ŸçŠ¶æ€")

    try:
        from utils.db_helper import get_db_info
        db_info = get_db_info()

        col1, col2, col3, col4 = st.columns(4)

        with col1:
            status = "âœ… æ­£å¸¸" if db_info['db_exists'] else "âš ï¸ æœªåˆå§‹åŒ–"
            st.metric("æ•°æ®åº“çŠ¶æ€", status)

        with col2:
            table_count = db_info.get('table_count', 0)
            st.metric("æ•°æ®è¡¨æ•°é‡", table_count)

        with col3:
            pool_count = db_info.get('stock_pool_count', 0)
            st.metric("è‚¡ç¥¨æ± æ•°é‡", pool_count)

        with col4:
            strategy_count = db_info.get('user_strategies_count', 0)
            st.metric("ç­–ç•¥æ•°é‡", strategy_count)

    except Exception as e:
        st.error(f"è·å–ç³»ç»ŸçŠ¶æ€å¤±è´¥: {e}")


def render_data_manager():
    """æ¸²æŸ“æ•°æ®ç®¡ç†é¡µé¢"""
    from modules import data_manager
    data_manager.render()


def render_indicators():
    """æ¸²æŸ“æŠ€æœ¯æŒ‡æ ‡é¡µé¢"""
    from modules import indicators
    indicators.render()


def render_strategies():
    """æ¸²æŸ“ç­–ç•¥é…ç½®é¡µé¢"""
    from modules import strategies
    strategies.render()


def render_selector():
    """æ¸²æŸ“é€‰è‚¡æ‰§è¡Œé¡µé¢"""
    from modules import selector
    selector.render()


def render_monitor():
    """æ¸²æŸ“å®æ—¶ç›‘æ§é¡µé¢"""
    from modules import monitor
    monitor.render()


def render_help():
    """æ¸²æŸ“å¸®åŠ©æ–‡æ¡£é¡µé¢"""
    st.title("ğŸ“š å¸®åŠ©æ–‡æ¡£")

    # åˆ›å»ºæ ‡ç­¾é¡µ
    tab1, tab2, tab3, tab4, tab5 = st.tabs([
        "ğŸ“– ä½¿ç”¨æŒ‡å—",
        "â“ å¸¸è§é—®é¢˜",
        "ğŸ“Š æŠ€æœ¯æŒ‡æ ‡è¯´æ˜",
        "âš™ï¸ ç­–ç•¥åŸç†",
        "ğŸ”§ æ•…éšœæ’æŸ¥"
    ])

    with tab1:
        render_user_guide()

    with tab2:
        render_faq()

    with tab3:
        render_indicators_guide()

    with tab4:
        render_strategy_guide()

    with tab5:
        render_troubleshooting()


def render_user_guide():
    """æ¸²æŸ“ç”¨æˆ·æŒ‡å—"""
    st.markdown("""
    ## ğŸ“– ç³»ç»Ÿä½¿ç”¨æŒ‡å—

    ### å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

    #### ç¬¬1æ­¥ï¼šä¸‹è½½æ•°æ®
    1. ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ çš„ **"ğŸ“Š æ•°æ®ç®¡ç†"**
    2. åœ¨ **"è‚¡ç¥¨æ± ç®¡ç†"** ä¸­æ·»åŠ è‚¡ç¥¨ä»£ç ï¼ˆå¦‚ï¼š600519.SHï¼‰
    3. åˆ‡æ¢åˆ° **"æ•°æ®ä¸‹è½½"** æ ‡ç­¾é¡µ
    4. é€‰æ‹©æ—¥æœŸèŒƒå›´å’Œå‘¨æœŸï¼Œç‚¹å‡»"å¼€å§‹ä¸‹è½½"

    #### ç¬¬2æ­¥ï¼šé…ç½®ç­–ç•¥
    1. ç‚¹å‡» **"âš™ï¸ ç­–ç•¥é…ç½®"**
    2. é€‰æ‹©ç­–ç•¥ç±»å‹ï¼ˆè¶‹åŠ¿å‹/çªç ´å‹/éœ‡è¡å‹ï¼‰
    3. é€‰æ‹©å…·ä½“ç­–ç•¥å¹¶è°ƒæ•´å‚æ•°
    4. ç‚¹å‡» **"ğŸ’¾ ä¿å­˜ç­–ç•¥"**

    #### ç¬¬3æ­¥ï¼šæ‰§è¡Œé€‰è‚¡
    1. ç‚¹å‡» **"ğŸ¯ æ‰§è¡Œé€‰è‚¡"**
    2. é€‰æ‹©å·²ä¿å­˜çš„ç­–ç•¥å’Œè‚¡ç¥¨æ± 
    3. ç‚¹å‡» **"ğŸ¯ å¼€å§‹é€‰è‚¡"**
    4. æŸ¥çœ‹ç»“æœå¹¶å¯¼å‡º

    ---

    ### åŠŸèƒ½æ¨¡å—ä»‹ç»

    #### ğŸ“Š æ•°æ®ç®¡ç†
    - **è‚¡ç¥¨æ± ç®¡ç†**ï¼šæ·»åŠ ã€åˆ é™¤ã€åˆ†ç»„ç®¡ç†è‚¡ç¥¨
    - **æ•°æ®ä¸‹è½½**ï¼šä¸‹è½½å†å²æ•°æ®ï¼ˆæ”¯æŒå¤šå‘¨æœŸï¼‰
    - **æ•°æ®æ›´æ–°**ï¼šå¢é‡æ›´æ–°æœ€æ–°æ•°æ®
    - **æ•°æ®æŸ¥è¯¢**ï¼šæŸ¥çœ‹å’Œå¯¼å‡ºæ•°æ®

    #### ğŸ“ˆ æŠ€æœ¯æŒ‡æ ‡
    - **æŒ‡æ ‡è®¡ç®—**ï¼šè‡ªåŠ¨è®¡ç®—MAã€MACDã€KDJã€RSIã€BOLLç­‰æŒ‡æ ‡
    - **Kçº¿å›¾è¡¨**ï¼šäº¤äº’å¼Kçº¿å›¾å’ŒæŒ‡æ ‡å›¾
    - **æŒ‡æ ‡æŸ¥è¯¢**ï¼šæŒ‰è‚¡ç¥¨ã€æ—¥æœŸæŸ¥è¯¢æŒ‡æ ‡æ•°æ®

    #### âš™ï¸ ç­–ç•¥é…ç½®
    - **ç­–ç•¥æ¨¡æ¿**ï¼š16ç§ç»å…¸ç­–ç•¥æ¨¡æ¿
    - **å‚æ•°é…ç½®**ï¼šå¯è§†åŒ–å‚æ•°è°ƒæ•´
    - **ç­–ç•¥ç®¡ç†**ï¼šä¿å­˜ã€ç¼–è¾‘ã€å¤åˆ¶ã€åˆ é™¤ç­–ç•¥

    #### ğŸ¯ æ‰§è¡Œé€‰è‚¡
    - **ç­–ç•¥æ‰§è¡Œ**ï¼šä¸€é”®æ‰§è¡Œé€‰è‚¡
    - **ç»“æœå±•ç¤º**ï¼šè¡¨æ ¼å±•ç¤ºé€‰è‚¡ç»“æœ
    - **å†å²è®°å½•**ï¼šæŸ¥çœ‹å’Œå¯¹æ¯”å†å²é€‰è‚¡

    #### ğŸ”” å®æ—¶ç›‘æ§
    - **ç›‘æ§è®¾ç½®**ï¼šè®¾ç½®ä»·æ ¼å’ŒæŒ‡æ ‡ç›‘æ§
    - **å®æ—¶æ£€æŸ¥**ï¼šè‡ªåŠ¨æ£€æŸ¥è§¦å‘æ¡ä»¶
    - **æé†’åŠŸèƒ½**ï¼šè§¦å‘æ—¶å¼¹çª—æé†’
    """)


def render_faq():
    """æ¸²æŸ“å¸¸è§é—®é¢˜"""
    st.markdown("""
    ## â“ å¸¸è§é—®é¢˜

    ### åŸºç¡€é—®é¢˜

    **Q: å¦‚ä½•å¼€å§‹ä½¿ç”¨ï¼Ÿ**
    A: æ–°æ‰‹å»ºè®®æŒ‰ä»¥ä¸‹æµç¨‹æ“ä½œï¼š
    1. å…ˆåœ¨"æ•°æ®ç®¡ç†"ä¸­æ·»åŠ å‡ åªè‚¡ç¥¨å¹¶ä¸‹è½½æ•°æ®
    2. åœ¨"ç­–ç•¥é…ç½®"ä¸­é€‰æ‹©ä¸€ä¸ªç®€å•ç­–ç•¥ï¼ˆå¦‚å‡çº¿å¤šå¤´æ’åˆ—ï¼‰
    3. åœ¨"æ‰§è¡Œé€‰è‚¡"ä¸­è¿è¡Œç­–ç•¥
    4. æŸ¥çœ‹ç»“æœå¹¶å¯¼å‡º

    **Q: æ”¯æŒå“ªäº›è‚¡ç¥¨ï¼Ÿ**
    A: æ”¯æŒAè‚¡å¸‚åœºæ‰€æœ‰è‚¡ç¥¨ï¼ŒåŒ…æ‹¬ï¼š
    - ä¸Šæµ·è¯åˆ¸äº¤æ˜“æ‰€ï¼š600xxx.SHã€688xxx.SHï¼ˆç§‘åˆ›æ¿ï¼‰
    - æ·±åœ³è¯åˆ¸äº¤æ˜“æ‰€ï¼š000xxx.SZã€002xxx.SZã€300xxx.SZï¼ˆåˆ›ä¸šæ¿ï¼‰

    **Q: æ•°æ®ä»å“ªé‡Œæ¥ï¼Ÿ**
    A: æ•°æ®æ¥è‡ªbaostockå…è´¹è¯åˆ¸æ•°æ®å¹³å°ï¼Œæ•°æ®å‡†ç¡®å¯é ã€‚

    **Q: è‚¡ç¥¨ä»£ç æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿ**
    A: æ ‡å‡†æ ¼å¼ä¸ºï¼šä»£ç .å¸‚åœº
    - ä¸Šæµ·å¸‚åœºï¼š600519.SHï¼ˆè´µå·èŒ…å°ï¼‰
    - æ·±åœ³å¸‚åœºï¼š000001.SZï¼ˆå¹³å®‰é“¶è¡Œï¼‰

    ### æ•°æ®ç›¸å…³é—®é¢˜

    **Q: æ”¯æŒå“ªäº›æ•°æ®å‘¨æœŸï¼Ÿ**
    A: æ”¯æŒ5ç§å‘¨æœŸï¼š
    - æ—¥çº¿ï¼ˆdï¼‰ï¼šæœ€å¸¸ç”¨ï¼Œé€‚åˆä¸­é•¿æœŸåˆ†æ
    - 60åˆ†é’Ÿï¼ˆ60mï¼‰ï¼šçŸ­çº¿åˆ†æ
    - 30åˆ†é’Ÿï¼ˆ30mï¼‰ï¼šçŸ­çº¿åˆ†æ
    - 15åˆ†é’Ÿï¼ˆ15mï¼‰ï¼šæ—¥å†…äº¤æ˜“
    - 5åˆ†é’Ÿï¼ˆ5mï¼‰ï¼šæ—¥å†…äº¤æ˜“

    **Q: æ•°æ®æ›´æ–°é¢‘ç‡ï¼Ÿ**
    A:
    - æ—¥çº¿æ•°æ®ï¼šæ¯ä¸ªäº¤æ˜“æ—¥æ”¶ç›˜åæ›´æ–°
    - åˆ†é’Ÿæ•°æ®ï¼šç›˜ä¸­æ•°æ®å¯èƒ½æœ‰å»¶è¿Ÿ
    - å»ºè®®æ¯å¤©æ”¶ç›˜åæ‰§è¡Œä¸€æ¬¡å¢é‡æ›´æ–°

    **Q: ä¸‹è½½æ•°æ®å¾ˆæ…¢æ€ä¹ˆåŠï¼Ÿ**
    A:
    - é¦–æ¬¡ä¸‹è½½å»ºè®®å…ˆä¸‹è½½æ•°é‡æµ‹è¯•
    - é¿å¼€é«˜å³°æ—¶æ®µï¼ˆ9:30-15:00ï¼‰
    - ä½¿ç”¨æ‰¹é‡å¯¼å…¥åŠŸèƒ½ï¼Œä¸€æ¬¡æ€§æ·»åŠ å¤šåªè‚¡ç¥¨

    **Q: æ•°æ®ç¼ºå¤±æ€ä¹ˆåŠï¼Ÿ**
    A:
    - ä½¿ç”¨"æ•°æ®æ›´æ–°"åŠŸèƒ½é‡æ–°ä¸‹è½½
    - æ£€æŸ¥ç½‘ç»œè¿æ¥
    - æŸäº›è‚¡ç¥¨å¯èƒ½åœç‰Œï¼Œå¯¼è‡´æ•°æ®ç¼ºå¤±

    ### ç­–ç•¥ç›¸å…³é—®é¢˜

    **Q: å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç­–ç•¥ï¼Ÿ**
    A: æ ¹æ®å¸‚åœºç¯å¢ƒé€‰æ‹©ï¼š
    - **ç‰›å¸‚/ä¸Šå‡è¶‹åŠ¿**ï¼šä½¿ç”¨è¶‹åŠ¿å‹ç­–ç•¥ï¼ˆå‡çº¿å¤šå¤´æ’åˆ—ã€MACDé‡‘å‰ï¼‰
    - **éœ‡è¡å¸‚**ï¼šä½¿ç”¨çªç ´å‹ç­–ç•¥ï¼ˆç®±ä½“çªç ´ã€æ”¾é‡çªç ´ï¼‰
    - **ç†Šå¸‚/ä¸‹è·Œ**ï¼šä½¿ç”¨éœ‡è¡å‹ç­–ç•¥ï¼ˆKDJä½ä½é‡‘å‰ã€RSIè¶…å–ï¼‰

    **Q: ç­–ç•¥å‚æ•°å¦‚ä½•è°ƒæ•´ï¼Ÿ**
    A:
    - ä¿å®ˆå‹ï¼šä¸¥æ ¼æ¡ä»¶ï¼Œä½é£é™©ï¼ˆå¦‚RSI < 20ï¼‰
    - æ¿€è¿›å‹ï¼šå®½æ¾æ¡ä»¶ï¼Œé«˜æ”¶ç›Šæ½œåŠ›ï¼ˆå¦‚RSI < 30ï¼‰
    - å»ºè®®å…ˆç”¨é»˜è®¤å€¼æµ‹è¯•ï¼Œå†æ ¹æ®ç»“æœè°ƒæ•´

    **Q: ä¸ºä»€ä¹ˆé€‰è‚¡ç»“æœä¸ºç©ºï¼Ÿ**
    A: å¯èƒ½åŸå› ï¼š
    1. ç­–ç•¥æ¡ä»¶è¿‡äºä¸¥æ ¼
    2. æ•°æ®æœªæ›´æ–°æˆ–ç¼ºå¤±
    3. å¸‚åœºç¯å¢ƒä¸é€‚ç”¨è¯¥ç­–ç•¥
    4. è‚¡ç¥¨æ± ä¸ºç©º

    **Q: é€‰è‚¡ç»“æœå‡†ç¡®å—ï¼Ÿ**
    A:
    - ç»“æœåŸºäºå†å²æ•°æ®å’ŒæŠ€æœ¯æŒ‡æ ‡è®¡ç®—
    - ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®
    - éœ€ç»“åˆå…¶ä»–åˆ†ææ–¹æ³•å’Œå¸‚åœºç¯å¢ƒ
    - è‚¡å¸‚æœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…

    ### æŠ€æœ¯é—®é¢˜

    **Q: å¯åŠ¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
    A: æ£€æŸ¥ï¼š
    1. Pythonç‰ˆæœ¬æ˜¯å¦ä¸º3.10+
    2. ä¾èµ–åŒ…æ˜¯å¦æ­£ç¡®å®‰è£…
    3. ç«¯å£8501æ˜¯å¦è¢«å ç”¨
    4. æŸ¥çœ‹é”™è¯¯æ—¥å¿—

    **Q: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ**
    A:
    1. å¤‡ä»½ `data/stock_data.db` æ•°æ®åº“æ–‡ä»¶
    2. å¯¼å‡ºé‡è¦çš„é€‰è‚¡ç»“æœ
    3. å¯¼å‡ºç­–ç•¥é…ç½®

    **Q: å¦‚ä½•æ¸…ç©ºæ•°æ®é‡æ–°å¼€å§‹ï¼Ÿ**
    A:
    1. å…³é—­åº”ç”¨
    2. åˆ é™¤ `data/stock_data.db` æ–‡ä»¶
    3. é‡æ–°å¯åŠ¨åº”ç”¨ï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºæ–°æ•°æ®åº“ï¼‰

    **Q: å†…å­˜ä¸è¶³æ€ä¹ˆåŠï¼Ÿ**
    A:
    - å‡å°‘åŒæ—¶ä¸‹è½½çš„è‚¡ç¥¨æ•°é‡
    - ç¼©çŸ­æ—¥æœŸèŒƒå›´
    - å…³é—­å…¶ä»–å ç”¨å†…å­˜çš„ç¨‹åº
    - å¢åŠ ç³»ç»Ÿå†…å­˜

    ### å…¶ä»–é—®é¢˜

    **Q: å¯ä»¥å›æµ‹ç­–ç•¥å—ï¼Ÿ**
    A: å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒè‡ªåŠ¨å›æµ‹ï¼Œå»ºè®®ï¼š
    - ä½¿ç”¨å†å²æ—¥æœŸæ‰§è¡Œé€‰è‚¡
    - æ‰‹åŠ¨å¯¹æ¯”åç»­èµ°åŠ¿
    - è®°å½•ç­–ç•¥è¡¨ç°

    **Q: å¯ä»¥æ”¯æŒå®ç›˜äº¤æ˜“å—ï¼Ÿ**
    A: ä¸æ”¯æŒã€‚æœ¬ç³»ç»Ÿä»…ç”¨äºé€‰è‚¡åˆ†æï¼Œä¸æä¾›äº¤æ˜“åŠŸèƒ½ã€‚

    **Q: å¦‚ä½•è·å–æ›´å¤šå¸®åŠ©ï¼Ÿ**
    A:
    1. æŸ¥çœ‹å®Œæ•´æ–‡æ¡£
    2. æŸ¥çœ‹å¿«é€Ÿæ•™ç¨‹
    3. æäº¤Issueåé¦ˆé—®é¢˜
    """)


def render_indicators_guide():
    """æ¸²æŸ“æŠ€æœ¯æŒ‡æ ‡è¯´æ˜"""
    st.markdown("""
    ## ğŸ“Š æŠ€æœ¯æŒ‡æ ‡è¯´æ˜

    ### MA å‡çº¿ï¼ˆMoving Averageï¼‰

    **åŸç†**ï¼š
    - è®¡ç®—ä¸€æ®µæ—¶é—´å†…çš„å¹³å‡ä»·æ ¼
    - å¸¸ç”¨å‘¨æœŸï¼š5æ—¥ã€10æ—¥ã€20æ—¥ã€60æ—¥

    **ä½¿ç”¨æ–¹æ³•**ï¼š
    - **å¤šå¤´æ’åˆ—**ï¼šçŸ­æœŸå‡çº¿åœ¨ä¸Šï¼Œé•¿æœŸå‡çº¿åœ¨ä¸‹ â†’ çœ‹æ¶¨ä¿¡å·
    - **ç©ºå¤´æ’åˆ—**ï¼šçŸ­æœŸå‡çº¿åœ¨ä¸‹ï¼Œé•¿æœŸå‡çº¿åœ¨ä¸Š â†’ çœ‹è·Œä¿¡å·
    - **é‡‘å‰**ï¼šçŸ­æœŸå‡çº¿ä¸Šç©¿é•¿æœŸå‡çº¿ â†’ ä¹°å…¥ä¿¡å·
    - **æ­»å‰**ï¼šçŸ­æœŸå‡çº¿ä¸‹ç©¿é•¿æœŸå‡çº¿ â†’ å–å‡ºä¿¡å·

    **é€‚ç”¨åœºæ™¯**ï¼šè¶‹åŠ¿æ˜ç¡®çš„å¸‚åœº

    ---

    ### MACD æŒ‡æ ‡

    **åŸç†**ï¼š
    - DIFï¼ˆå¿«çº¿ï¼‰= EMA(12) - EMA(26)
    - DEAï¼ˆæ…¢çº¿ï¼‰= EMA(DIF, 9)
    - MACD = (DIF - DEA) Ã— 2

    **ä½¿ç”¨æ–¹æ³•**ï¼š
    - **é‡‘å‰**ï¼šDIFä¸Šç©¿DEAï¼Œä¸”MACDç”±è´Ÿè½¬æ­£ â†’ å¼ºçƒˆä¹°å…¥ä¿¡å·
    - **æ­»å‰**ï¼šDIFä¸‹ç©¿DEAï¼Œä¸”MACDç”±æ­£è½¬è´Ÿ â†’ å¼ºçƒˆå–å‡ºä¿¡å·
    - **çº¢æŸ±æ”¾å¤§**ï¼šä¸Šæ¶¨åŠ¨èƒ½å¢å¼º
    - **ç»¿æŸ±æ”¾å¤§**ï¼šä¸‹è·ŒåŠ¨èƒ½å¢å¼º

    **é€‚ç”¨åœºæ™¯**ï¼šè¶‹åŠ¿å¸‚åœºï¼Œæ•æ‰ä¹°å–ç‚¹

    ---

    ### KDJ æŒ‡æ ‡

    **åŸç†**ï¼š
    - Kå€¼ï¼šå¿«é€Ÿéšæœºå€¼
    - Då€¼ï¼šæ…¢é€Ÿéšæœºå€¼
    - Jå€¼ï¼šä¹–ç¦»å€¼

    **ä½¿ç”¨æ–¹æ³•**ï¼š
    - **è¶…ä¹°åŒº**ï¼šK/D > 80 â†’ å¯èƒ½å›è°ƒ
    - **è¶…å–åŒº**ï¼šK/D < 20 â†’ å¯èƒ½åå¼¹
    - **é‡‘å‰**ï¼šKçº¿ä¸Šç©¿Dçº¿ â†’ ä¹°å…¥ä¿¡å·
    - **ä½ä½é‡‘å‰**ï¼šåœ¨è¶…å–åŒºé‡‘å‰ â†’ æ›´å¯é 
    - **é«˜ä½æ­»å‰**ï¼šåœ¨è¶…ä¹°åŒºæ­»å‰ â†’ æ›´å¯é 

    **é€‚ç”¨åœºæ™¯**ï¼šéœ‡è¡å¸‚åœºï¼Œæ•æ‰è¶…ä¹°è¶…å–

    ---

    ### RSI æŒ‡æ ‡ï¼ˆRelative Strength Indexï¼‰

    **åŸç†**ï¼š
    - è¡¡é‡ä»·æ ¼ä¸Šæ¶¨å’Œä¸‹è·Œçš„åŠ›åº¦
    - å–å€¼èŒƒå›´ï¼š0-100

    **ä½¿ç”¨æ–¹æ³•**ï¼š
    - **è¶…ä¹°**ï¼šRSI > 70 â†’ å¯èƒ½å›è°ƒ
    - **è¶…å–**ï¼šRSI < 30 â†’ å¯èƒ½åå¼¹
    - **å¼ºåŠ¿**ï¼šRSI > 50
    - **å¼±åŠ¿**ï¼šRSI < 50
    - **èƒŒç¦»**ï¼šä»·æ ¼åˆ›æ–°é«˜ä½†RSIä¸åˆ›æ–°é«˜ â†’ é¡¶éƒ¨ä¿¡å·

    **é€‚ç”¨åœºæ™¯**ï¼šéœ‡è¡å¸‚åœºï¼Œåˆ¤æ–­è¶…ä¹°è¶…å–

    ---

    ### BOLL å¸ƒæ—å¸¦ï¼ˆBollinger Bandsï¼‰

    **åŸç†**ï¼š
    - ä¸Šè½¨ = ä¸­è½¨ + 2Ã—æ ‡å‡†å·®
    - ä¸­è½¨ = 20æ—¥å‡çº¿
    - ä¸‹è½¨ = ä¸­è½¨ - 2Ã—æ ‡å‡†å·®

    **ä½¿ç”¨æ–¹æ³•**ï¼š
    - **è§¦åŠä¸Šè½¨**ï¼šå¯èƒ½å›è°ƒæˆ–çªç ´
    - **è§¦åŠä¸‹è½¨**ï¼šå¯èƒ½åå¼¹æˆ–ç ´ä½
    - **æ”¶å£**ï¼šæ³¢åŠ¨å‡å°ï¼Œå³å°†å˜ç›˜
    - **å¼€å£**ï¼šæ³¢åŠ¨å¢å¤§ï¼Œè¶‹åŠ¿å½¢æˆ
    - **ä»·æ ¼åœ¨ä¸­è½¨ä¸Šæ–¹**ï¼šå¼ºåŠ¿
    - **ä»·æ ¼åœ¨ä¸­è½¨ä¸‹æ–¹**ï¼šå¼±åŠ¿

    **é€‚ç”¨åœºæ™¯**ï¼šåˆ¤æ–­æ³¢åŠ¨èŒƒå›´å’Œçªç ´æ—¶æœº

    ---

    ### ATR çœŸå®æ³¢å¹…ï¼ˆAverage True Rangeï¼‰

    **åŸç†**ï¼š
    - è¡¡é‡ä»·æ ¼æ³¢åŠ¨çš„å‰§çƒˆç¨‹åº¦
    - ä¸è€ƒè™‘æ–¹å‘ï¼Œåªçœ‹æ³¢åŠ¨å¹…åº¦

    **ä½¿ç”¨æ–¹æ³•**ï¼š
    - **ATRä¸Šå‡**ï¼šæ³¢åŠ¨å¢å¤§ï¼Œæ³¨æ„é£é™©
    - **ATRä¸‹é™**ï¼šæ³¢åŠ¨å‡å°ï¼Œå¯èƒ½æ•´ç†
    - **è®¾ç½®æ­¢æŸ**ï¼šATRçš„2-3å€ä½œä¸ºæ­¢æŸä½

    **é€‚ç”¨åœºæ™¯**ï¼šé£é™©ç®¡ç†å’Œæ­¢æŸè®¾ç½®
    """)


def render_strategy_guide():
    """æ¸²æŸ“ç­–ç•¥åŸç†"""
    st.markdown("""
    ## âš™ï¸ ç­–ç•¥åŸç†è¯¦è§£

    ### è¶‹åŠ¿å‹ç­–ç•¥

    #### å‡çº¿å¤šå¤´æ’åˆ—
    **åŸç†**ï¼š
    - çŸ­æœŸå‡çº¿ > ä¸­æœŸå‡çº¿ > é•¿æœŸå‡çº¿
    - è¡¨ç¤ºä¸Šå‡è¶‹åŠ¿æ˜ç¡®

    **æœ€ä½³ä½¿ç”¨åœºæ™¯**ï¼š
    - ç‰›å¸‚æˆ–æ˜ç¡®ä¸Šå‡è¶‹åŠ¿
    - æˆäº¤é‡é…åˆæ”¾å¤§

    **æ³¨æ„äº‹é¡¹**ï¼š
    - éœ€ç¡®è®¤è¶‹åŠ¿æˆç«‹
    - æ³¨æ„å‡çº¿å‘æ•£ç¨‹åº¦

    ---

    #### MACDé‡‘å‰
    **åŸç†**ï¼š
    - DIFä¸Šç©¿DEA
    - MACDæŸ±ç”±è´Ÿè½¬æ­£

    **æœ€ä½³ä½¿ç”¨åœºæ™¯**ï¼š
    - è¶‹åŠ¿è½¬æŠ˜ç‚¹
    - ä¸‹è·Œåçš„åå¼¹

    **æ³¨æ„äº‹é¡¹**ï¼š
    - é›¶è½´ä¸Šæ–¹çš„é‡‘å‰æ›´å¯é 
    - éœ€é…åˆæˆäº¤é‡

    ---

    ### çªç ´å‹ç­–ç•¥

    #### ç®±ä½“çªç ´
    **åŸç†**ï¼š
    - ä»·æ ¼çªç ´æ¨ªç›˜æ•´ç†åŒºé—´
    - æ”¾é‡ç¡®è®¤æ›´å¯é 

    **æœ€ä½³ä½¿ç”¨åœºæ™¯**ï¼š
    - é•¿æœŸæ¨ªç›˜å
    - æ”¾é‡çªç ´

    **æ³¨æ„äº‹é¡¹**ï¼š
    - éœ€ç¡®è®¤çªç ´æœ‰æ•ˆæ€§
    - è®¾ç½®æ­¢æŸä½

    ---

    #### æ”¾é‡çªç ´
    **åŸç†**ï¼š
    - ä»·æ ¼çªç ´ + æˆäº¤é‡æ”¾å¤§
    - è¡¨æ˜èµ„é‡‘ç§¯æå‚ä¸

    **æœ€ä½³ä½¿ç”¨åœºæ™¯**ï¼š
    - å…³é”®é˜»åŠ›ä½çªç ´
    - åº•éƒ¨å¯åŠ¨

    **æ³¨æ„äº‹é¡¹**ï¼š
    - çªç ´åéœ€å›è¸©ç¡®è®¤
    - é¿å…å‡çªç ´

    ---

    ### éœ‡è¡å‹ç­–ç•¥

    #### KDJä½ä½é‡‘å‰
    **åŸç†**ï¼š
    - KDJåœ¨è¶…å–åŒºé‡‘å‰
    - è¡¨ç¤ºçŸ­æœŸè¶…å–åå¼¹

    **æœ€ä½³ä½¿ç”¨åœºæ™¯**ï¼š
    - ä¸‹è·Œæœ«æœŸ
    - çŸ­çº¿æ“ä½œ

    **æ³¨æ„äº‹é¡¹**ï¼š
    - å¿«è¿›å¿«å‡º
    - ä¸¥æ ¼æ­¢æŸ

    ---

    #### RSIè¶…å–
    **åŸç†**ï¼š
    - RSIä½äº30
    - è¡¨ç¤ºä¸¥é‡è¶…å–

    **æœ€ä½³ä½¿ç”¨åœºæ™¯**ï¼š
    - ææ…Œæ€§ä¸‹è·Œ
    - æŠ€æœ¯æ€§åå¼¹

    **æ³¨æ„äº‹é¡¹**ï¼š
    - è¶‹åŠ¿ä¸‹è·Œæ—¶æ…ç”¨
    - æ³¨æ„é£é™©æ§åˆ¶

    ---

    ### ç­–ç•¥ç»„åˆå»ºè®®

    **ä¿å®ˆå‹ç»„åˆ**ï¼š
    - å‡çº¿å¤šå¤´æ’åˆ—ï¼ˆä¸»ç­–ç•¥ï¼‰
    - MACDé‡‘å‰ï¼ˆç¡®è®¤ï¼‰
    - æˆäº¤é‡æ”¾å¤§ï¼ˆéªŒè¯ï¼‰

    **æ¿€è¿›å‹ç»„åˆ**ï¼š
    - KDJä½ä½é‡‘å‰ï¼ˆä¿¡å·ï¼‰
    - RSIè¶…å–ï¼ˆç¡®è®¤ï¼‰
    - ç®±ä½“çªç ´ï¼ˆéªŒè¯ï¼‰

    **è¶‹åŠ¿è·Ÿè¸ªç»„åˆ**ï¼š
    - å‡çº¿å¤šå¤´æ’åˆ—ï¼ˆè¶‹åŠ¿ï¼‰
    - MACDçº¢æŸ±æ”¾å¤§ï¼ˆåŠ¨èƒ½ï¼‰
    - ä»·æ ¼ç«™ç¨³ä¸­è½¨ï¼ˆä½ç½®ï¼‰
    """)


def render_troubleshooting():
    """æ¸²æŸ“æ•…éšœæ’æŸ¥"""
    st.markdown("""
    ## ğŸ”§ æ•…éšœæ’æŸ¥

    ### åº”ç”¨å¯åŠ¨é—®é¢˜

    **é—®é¢˜ï¼šå¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–Streamlitåº”ç”¨åœ¨è¿è¡Œ
    2. å…³é—­å ç”¨8501ç«¯å£çš„ç¨‹åº
    3. æˆ–ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‡å®šå…¶ä»–ç«¯å£ï¼š
       streamlit run app.py --server.port 8502
    ```

    **é—®é¢˜ï¼šå¯åŠ¨åé¡µé¢ç©ºç™½**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
    2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
    3. å°è¯•ä½¿ç”¨å…¶ä»–æµè§ˆå™¨
    4. é‡æ–°å¯åŠ¨åº”ç”¨
    ```

    ### æ•°æ®ä¸‹è½½é—®é¢˜

    **é—®é¢˜ï¼šä¸‹è½½å¤±è´¥ï¼Œæç¤ºç½‘ç»œé”™è¯¯**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. æ£€æŸ¥ç½‘ç»œè¿æ¥
    2. ç¡®è®¤èƒ½è®¿é—®baostockæœåŠ¡å™¨
    3. å‡å°‘åŒæ—¶ä¸‹è½½çš„è‚¡ç¥¨æ•°é‡
    4. å¢åŠ ä¸‹è½½å»¶è¿Ÿæ—¶é—´
    ```

    **é—®é¢˜ï¼šä¸‹è½½çš„æ•°æ®ä¸ºç©º**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. æ£€æŸ¥è‚¡ç¥¨ä»£ç æ ¼å¼æ˜¯å¦æ­£ç¡®
    2. ç¡®è®¤è‚¡ç¥¨æ˜¯å¦å­˜åœ¨
    3. æ£€æŸ¥æ—¥æœŸèŒƒå›´æ˜¯å¦åˆç†
    4. æŸäº›æ–°è‚¡å¯èƒ½å†å²æ•°æ®ä¸è¶³
    ```

    **é—®é¢˜ï¼šä¸‹è½½é€Ÿåº¦å¾ˆæ…¢**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. é¿å¼€äº¤æ˜“æ—¶æ®µï¼ˆ9:30-15:00ï¼‰
    2. å‡å°‘åŒæ—¶ä¸‹è½½çš„è‚¡ç¥¨æ•°é‡
    3. ç¼©çŸ­æ—¥æœŸèŒƒå›´
    4. åˆ†æ‰¹ä¸‹è½½ä¸åŒè‚¡ç¥¨
    ```

    ### æ•°æ®æ˜¾ç¤ºé—®é¢˜

    **é—®é¢˜ï¼šå›¾è¡¨ä¸æ˜¾ç¤º**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®
    2. ç¡®è®¤æŒ‡æ ‡å·²è®¡ç®—
    3. åˆ·æ–°é¡µé¢
    4. æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§
    ```

    **é—®é¢˜ï¼šæŒ‡æ ‡æ•°æ®ä¸ºç©º**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. å…ˆåœ¨"æŠ€æœ¯æŒ‡æ ‡"é¡µé¢è®¡ç®—æŒ‡æ ‡
    2. ç¡®è®¤æœ‰è¶³å¤Ÿçš„Kçº¿æ•°æ®
    3. æ£€æŸ¥è®¡ç®—å‚æ•°æ˜¯å¦åˆç†
    ```

    ### é€‰è‚¡æ‰§è¡Œé—®é¢˜

    **é—®é¢˜ï¼šé€‰è‚¡ç»“æœä¸ºç©º**
    ```
    å¯èƒ½åŸå› ï¼š
    1. ç­–ç•¥æ¡ä»¶è¿‡äºä¸¥æ ¼
    2. æ•°æ®æœªæ›´æ–°æˆ–ç¼ºå¤±
    3. è‚¡ç¥¨æ± ä¸ºç©º
    4. å¸‚åœºç¯å¢ƒä¸é€‚ç”¨

    è§£å†³æ–¹æ³•ï¼š
    1. æ”¾å®½ç­–ç•¥å‚æ•°
    2. æ›´æ–°æ•°æ®
    3. æ£€æŸ¥è‚¡ç¥¨æ± 
    4. æ›´æ¢ç­–ç•¥ç±»å‹
    ```

    **é—®é¢˜ï¼šé€‰è‚¡é€Ÿåº¦å¾ˆæ…¢**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. å‡å°‘è‚¡ç¥¨æ± æ•°é‡
    2. ä¼˜åŒ–ç­–ç•¥æ¡ä»¶
    3. ä½¿ç”¨ç´¢å¼•ï¼ˆå·²è‡ªåŠ¨åˆ›å»ºï¼‰
    4. æ¸…ç†å†å²æ•°æ®
    ```

    ### æ€§èƒ½é—®é¢˜

    **é—®é¢˜ï¼šåº”ç”¨è¿è¡Œå¡é¡¿**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. å…³é—­ä¸éœ€è¦çš„æµè§ˆå™¨æ ‡ç­¾
    2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
    3. å‡å°‘æ•°æ®å±•ç¤ºé‡
    4. å¢åŠ ç³»ç»Ÿå†…å­˜
    5. ä½¿ç”¨æ•°æ®åˆ†é¡µåŠŸèƒ½
    ```

    **é—®é¢˜ï¼šå†…å­˜å ç”¨è¿‡é«˜**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. ç¼©çŸ­æ•°æ®æŸ¥è¯¢èŒƒå›´
    2. å®šæœŸæ¸…ç†å†å²è®°å½•
    3. å‡å°‘åŒæ—¶æ‰“å¼€çš„å›¾è¡¨
    4. é‡å¯åº”ç”¨
    ```

    ### æ•°æ®åº“é—®é¢˜

    **é—®é¢˜ï¼šæ•°æ®åº“é”å®š**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. å…³é—­æ‰€æœ‰åº”ç”¨å®ä¾‹
    2. æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç¨‹åºå ç”¨æ•°æ®åº“
    3. é‡å¯åº”ç”¨
    4. å¦‚æ•°æ®åº“æŸåï¼Œåˆ é™¤åé‡æ–°åˆå§‹åŒ–
    ```

    **é—®é¢˜ï¼šæ•°æ®ä¸¢å¤±**
    ```
    è§£å†³æ–¹æ³•ï¼š
    1. æ£€æŸ¥data/stock_data.dbæ–‡ä»¶æ˜¯å¦å­˜åœ¨
    2. æ¢å¤å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶
    3. å¦‚æ— å¤‡ä»½ï¼Œé‡æ–°ä¸‹è½½å’Œè®¡ç®—æ•°æ®
    ```

    ### è·å–å¸®åŠ©

    å¦‚æœä»¥ä¸Šæ–¹æ³•æ— æ³•è§£å†³é—®é¢˜ï¼š

    1. **æŸ¥çœ‹æ—¥å¿—**ï¼š
       - ä½ç½®ï¼š`logs/app.log`
       - è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

    2. **æäº¤Issue**ï¼š
       - æè¿°é—®é¢˜è¯¦ç»†æƒ…å†µ
       - æä¾›é”™è¯¯æ—¥å¿—
       - è¯´æ˜ç³»ç»Ÿç¯å¢ƒ

    3. **æŸ¥çœ‹æ–‡æ¡£**ï¼š
       - å®Œæ•´ä½¿ç”¨æ–‡æ¡£
       - å¿«é€Ÿæ•™ç¨‹
       - å¸¸è§é—®é¢˜FAQ
    """)


# ============ ä¸»åº”ç”¨ ============

def main():
    """ä¸»åº”ç”¨å‡½æ•°"""

    # åˆå§‹åŒ–ä¼šè¯çŠ¶æ€
    init_session_state()

    # ä¾§è¾¹æ å¯¼èˆª
    with st.sidebar:
        st.markdown(f"### {config.APP_NAME}")
        st.markdown(f"**v{config.APP_VERSION}**")
        st.markdown("---")

        page = st.radio(
            "å¯¼èˆªèœå•",
            [
                "ğŸ  é¦–é¡µ",
                "ğŸ“Š æ•°æ®ç®¡ç†",
                "ğŸ“ˆ æŠ€æœ¯æŒ‡æ ‡",
                "âš™ï¸ ç­–ç•¥é…ç½®",
                "ğŸ¯ æ‰§è¡Œé€‰è‚¡",
                "ğŸ”” å®æ—¶ç›‘æ§",
                "ğŸ“š å¸®åŠ©æ–‡æ¡£"
            ],
            label_visibility="collapsed"
        )

        st.markdown("---")

        # å¿«é€Ÿé“¾æ¥
        st.markdown("### ğŸš€ å¿«é€Ÿå¼€å§‹")
        if st.button("ğŸ“– å¿«é€Ÿæ•™ç¨‹", use_container_width=True):
            st.session_state.show_tutorial = True
            st.rerun()

        st.markdown("---")
        st.caption(f"{config.APP_DESCRIPTION}")

    # æ˜¾ç¤ºæ•™ç¨‹ï¼ˆå¦‚æœæ¿€æ´»ï¼‰
    if st.session_state.get('show_tutorial', False):
        from utils.onboarding import render_quick_tutorial
        render_quick_tutorial()
        return

    # é¦–æ¬¡è¿è¡Œå¼•å¯¼
    from utils.onboarding import check_first_run, render_welcome_modal
    if check_first_run():
        render_welcome_modal()

    # è·¯ç”±åˆ°ä¸åŒé¡µé¢
    if page == "ğŸ  é¦–é¡µ":
        render_home()
    elif page == "ğŸ“Š æ•°æ®ç®¡ç†":
        render_data_manager()
        from utils.onboarding import render_context_help
        render_context_help(page)
    elif page == "ğŸ“ˆ æŠ€æœ¯æŒ‡æ ‡":
        render_indicators()
        from utils.onboarding import render_context_help
        render_context_help(page)
    elif page == "âš™ï¸ ç­–ç•¥é…ç½®":
        render_strategies()
        from utils.onboarding import render_context_help
        render_context_help(page)
    elif page == "ğŸ¯ æ‰§è¡Œé€‰è‚¡":
        render_selector()
        from utils.onboarding import render_context_help
        render_context_help(page)
    elif page == "ğŸ”” å®æ—¶ç›‘æ§":
        render_monitor()
        from utils.onboarding import render_context_help
        render_context_help(page)
    elif page == "ğŸ“š å¸®åŠ©æ–‡æ¡£":
        render_help()


if __name__ == "__main__":
    main()
